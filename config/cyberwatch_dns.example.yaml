# CyberWatch DNS Collector Configuration
#
# NOTE: Pi-hole settings can also be configured via the Web UI at /settings
# Database-stored settings (from the UI) take precedence over this file.
#
# To configure via UI: Navigate to http://your-server:8080/settings

enabled: true
source: "pihole"  # or "logfile"

# Pi-hole Configuration (v5 and v6 supported)
# For Pi-hole v6: Use your web interface password as the API token
# For Pi-hole v5: Find token in Settings → API → Show API token
pihole:
  base_url: "http://pihole.local"  # Just the base URL, no /admin/api.php needed
  api_token: "REPLACE_ME"
  poll_interval_seconds: 30

# Alternative: Tail Pi-hole log file directly
logfile:
  log_path: "/var/log/pihole.log"
  format: "pihole_ftl"
  poll_interval_seconds: 10

# Filter settings to reduce noise in DNS activity
# NOTE: CyberWatch automatically ignores its own enrichment traffic:
#   - *.origin.asn.cymru.com (Team Cymru ASN lookups)
#   - *.peer.asn.cymru.com (Team Cymru peer lookups)
#   - Reverse DNS lookups (*.in-addr.arpa, *.ip6.arpa)
#   - IP-prefixed domains like 1.2.3.4.origin.asn.cymru.com
filters:
  ignore_domains_suffix:
    - ".local"
    - ".lan"
  ignore_qtypes:
    - "PTR"
  # To hide CyberWatch's own DNS requests, add its LAN IP here:
  # e.g., if CyberWatch runs on 192.168.1.100, add it to ignore_clients
  ignore_clients: []
  max_domain_length: 255

dns_resolution:
  enabled: true
  timeout_seconds: 2
  max_ips_per_domain: 4

# Logging Configuration (Environment Variables)
# These can be set in systemd unit files or shell environment
# CYBERWATCH_LOG_LEVEL: INFO|DEBUG|WARNING|ERROR|CRITICAL (default: INFO)
# CYBERWATCH_LOG_FILE: Path to JSONL log file (default: logs/cyberwatch.jsonl)
# CYBERWATCH_LOG_MAX_BYTES: Max bytes per log file before rotation (default: 104857600 = 100MB)
